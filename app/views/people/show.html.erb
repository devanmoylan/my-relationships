<%= link_to '< People', user_people_path(@user) %>
<div class="jumbotron">
  <div class="row">
    <div class="col-3">
      <%= image_tag avatar(@person, 200), class: 'rounded' %>
    </div>
    <div class="col-9">
      <h1>Person</h1>
      <p>
        <strong>First name:</strong>
        <%= @person.first_name %>
      </p>

      <p>
        <strong>Last name:</strong>
        <%= @person.last_name %>
      </p>

      <p>
        <strong>Birthday:</strong>
        <%= @person.birthday %> <%= "(age: ~#{@person.age})" if @person.age %>
      </p>

      <%= link_to 'Edit', edit_user_person_path(@user, @person) %>
    </div>
  </div>
</div>
<div class="row">
  <div class="col-8">
    <h2>Interactions</h2>
    <%= link_to 'New Interaction', new_user_person_interaction_path(@user, @person) %>

    <br>
    <br>

    <% @person.interactions.each do |interaction| %>
      <div class="card" style="padding:20px">
        <div class="card-body">
          <h5 class="card-title"><%= interaction.location %></h5>
          <h6 class="card-subtitle mb-2 text-muted"><%= interaction.created_at.strftime("%B %-d, %Y") %></h6>
          <table>
            <% interaction.attributes.each do |k, v| %>
              <tr>
                <th><%= k %></th>
                <td><%= v %></td>
              </tr>
            <% end %>
            <td></td>
          </table>
          <%= link_to 'Edit', edit_user_person_interaction_path(@user, @person, interaction) %> | <%= link_to 'Destroy', user_person_interaction_path(@user, @person, interaction), method: :delete, data: {confirm: 'Are you sure?'} %>
        </div>
      </div>
    <% end %>
  </div>

  <div class="col-4">

    <h2>Connections</h2>

    <table>
      <thead>
      <tr>
        <th>First name</th>
        <th>Last name</th>
        <th>User</th>
        <th colspan="3"></th>
      </tr>
      </thead>

      <tbody>
      <% @person.all_connections.each do |friend| %>
        <tr>
          <td><%= friend.first_name %></td>
          <td><%= friend.last_name %></td>
          <td><%= link_to 'Edit', edit_user_person_person_path(@user, @person, friend) %></td>
          <td><%= link_to 'Destroy', user_person_person_path(@user, @person, friend), method: :delete, data: {confirm: 'Are you sure?'} %></td>
        </tr>
      <% end %>
      </tbody>
    </table>

    <br>

    <%= link_to 'New Person', new_user_person_person_path(@user, @person) %>

    <h2>Experiences</h2>

    <table>
      <thead>
      <tr>
        <th>Experience type</th>
        <th>Start date</th>
        <th>End date</th>
        <th>Location</th>
        <th>Description</th>
        <th>Role</th>
        <th colspan="3"></th>
      </tr>
      </thead>

      <tbody>
      <% @person.experiences.order(end_date: :desc).each do |experience| %>
        <tr>
          <td><%= experience.experience_type %></td>
          <td><%= experience.start_date %></td>
          <td><%= experience.end_date %></td>
          <td><%= experience.location %></td>
          <td><%= experience.description %></td>
          <td><%= experience.role %></td>
          <td><%= link_to 'Edit', edit_user_person_experience_path(@user, @person, experience) %></td>
          <td><%= link_to 'Destroy', user_person_experience_path(@user, @person, experience), method: :delete, data: {confirm: 'Are you sure?'} %></td>
        </tr>
      <% end %>
      </tbody>
    </table>

    <br>

    <%= link_to 'New Experience', new_user_person_experience_path(@user, @person) %>

    <h2>Events</h2>

    <table>
      <thead>
      <tr>
        <th>Date</th>
        <th>Duration</th>
        <th>Role</th>
        <th>Description</th>
        <th>Title</th>
        <th>Location</th>
        <th colspan="3"></th>
      </tr>
      </thead>

      <tbody>
      <% @person.events.order(date: :desc).each do |event| %>
        <tr>
          <td><%= event.date %></td>
          <td><%= event.duration %></td>
          <td><%= event.role %></td>
          <td><%= event.description %></td>
          <td><%= event.title %></td>
          <td><%= event.location %></td>
          <td><%= link_to 'Edit', edit_user_person_event_path(@user, @person, event) %></td>
          <td><%= link_to 'Destroy', user_person_event_path(@user, @person, event), method: :delete, data: {confirm: 'Are you sure?'} %></td>
        </tr>
      <% end %>
      </tbody>
    </table>

    <br>

    <%= link_to 'New Event', new_user_person_event_path(@user, @person) %>

    <h2>Interests</h2>

    <table>
      <thead>
      <tr>
        <th>Name</th>
        <th>Level</th>
        <th colspan="3"></th>
      </tr>
      </thead>

      <tbody>
      <% @person.interests.each do |interest| %>
        <tr>
          <td><%= interest.name %></td>
          <td><%= interest.level %></td>
          <td><%= link_to 'Edit', edit_user_person_interest_path(@user, @person, interest) %></td>
          <td><%= link_to 'Destroy', user_person_interest_path(@user, @person, interest), method: :delete, data: {confirm: 'Are you sure?'} %></td>
        </tr>
      <% end %>
      </tbody>
    </table>

    <br>

    <%= link_to 'New Interest', new_user_person_interest_path(@user, @person) %>

  </div>
</div>
